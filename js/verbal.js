const questions = [
    {
        "question": "Seleccione la opción que contenga el par de palabras que den sentido a la oración. 1. CREENCIA  ",
        "options": [
            "Docto",
            "Fuerte",
            "Atento",
            "Dogma"
        ],
        "correct": "Dogma",
        "subject": "Verbal",
        "id": "M001",
        "flag": false
    },
    {
        "question": "SOSIEGO",
        "options": [
            "Calma",
            "Llanto",
            "Ruido",
            "Bacanal"
        ],
        "correct": "Calma",
        "subject": "Verbal",
        "id": "M002",
        "flag": false
    },
    {
        "question": "INDESCRIPTIBLE",
        "options": [
            "Indescifrable",
            "Inefable",
            "Inestable",
            "Indeseable"
        ],
        "correct": "Inefable",
        "subject": "Verbal",
        "id": "M003",
        "flag": false
    },
    {
        "question": "IGUALDAD",
        "options": [
            "Concordancia",
            "Diversidad",
            "Disparidad",
            "Desavenencia"
        ],
        "correct": "Concordancia",
        "subject": "Verbal",
        "id": "M004",
        "flag": false
    },
    {
        "question": "SALARIO",
        "options": [
            "Saldo",
            "Paga",
            "Sueldo",
            "Jornal"
        ],
        "correct": "Sueldo",
        "subject": "Verbal",
        "id": "M005",
        "flag": false
    },
    {
        "question": "DOCTO",
        "options": [
            "Diestro",
            "Aficionado",
            "Erudito",
            "Agradable"
        ],
        "correct": "Erudito",
        "subject": "Verbal",
        "id": "M006",
        "flag": false
    },
    {
        "question": "PARLACHÍN",
        "options": [
            "Alocado",
            "Locuaz",
            "Justiciero",
            "Aniñado"
        ],
        "correct": "Locuaz",
        "subject": "Verbal",
        "id": "M007",
        "flag": false
    },
    {
        "question": "MEZQUINO",
        "options": [
            "Malvado",
            "Soberbio",
            "Avaro",
            "Inconsciente"
        ],
        "correct": "Avaro",
        "subject": "Verbal",
        "id": "M008",
        "flag": false
    },
    {
        "question": "En los siguientes reactivos, seleccione la opción que se asemeje al significado OPUESTO de la palabra en mayúscula. 9. INDIFERENCIA",
        "options": [
            "Apatía",
            "Fanatismo",
            "Pereza",
            "Tolerancia"
        ],
        "correct": "Fanatismo",
        "subject": "Verbal",
        "id": "M009",
        "flag": false
    },
    {
        "question": "PROSPERAR",
        "options": [
            "Bloquear",
            "Menguar",
            "Salvar",
            "Acortar"
        ],
        "correct": "Menguar",
        "subject": "Verbal",
        "id": "M010",
        "flag": false
    },
    {
        "question": "DILIGENCIA",
        "options": [
            "Desidia",
            "Cobarde",
            "Nacimiento",
            "Acierto"
        ],
        "correct": "Desidia",
        "subject": "Verbal",
        "id": "M011",
        "flag": false
    },
    {
        "question": "La palabra que tiene el mismo significado que caduco es:",
        "options": [
            "Terminado",
            "Prohibido",
            "Suspensión",
            "Perecedero"
        ],
        "correct": "Terminado",
        "subject": "Verbal",
        "id": "M012",
        "flag": false
    },
    {
        "question": " Identifique la palabra que tenga significado opuesto a nepotismo.",
        "options": [
            "Dominio",
            "Severidad",
            "Equidad",
            "Benevolencia"
        ],
        "correct": "Equidad",
        "subject": "Verbal",
        "id": "M013",
        "flag": false
    },
    {
        "question": "  ¿Cuál de las cinco cosas abajo citadas no corresponde a las otras? ",
        "options": [
            "Rosa",
            "Clavel",
            "Violeta",
            "Uva"
        ],
        "correct": "Uva",
        "subject": "Verbal",
        "id": "M014",
        "flag": false
    },
    {
        "question": "Identifique el antónimo de la palabra marcada en negrita. La primera competencia importante para esta forma de inteligencia es una percepción exacta de la realidad visible. Para esto la persona tiene que poder adaptar la imagen de un espacio u objeto recientemente formada cuando las nuevas percepciones así lo requieran . ",
        "options": [
            "Clarividencia ",
            "Ignoto",
            "Conocimiento",
            "Discernimiento"
        ],
        "correct": "Ignoto",
        "subject": "Verbal",
        "id": "M015",
        "flag": false
    },
    {
        "question": "  Elija la opción que complete la oración de acuerdo al orden sintáctico. 1. En las playas ecuatorianas  2. Nacionales y extranjeros  3. De un clima maravilloso   4. Bañistas  5. Disfrutaron este feriado ",
        "options": [
            "1, 4, 2, 5, 3",
            "4, 2, 5, 3, 1",
            "2, 4, 5, 1, 3",
            "5, 4, 2, 3, 1"
        ],
        "correct": "4, 2, 5, 3, 1",
        "subject": "Verbal",
        "id": "M016",
        "flag": false
    },
    {
        "question": " Todas son ideas secundarias, excepto: El estudio del movimiento se refiere al cambio de ubicación en el espacio y en el tiempo, tal como es medido por un observador físico. Por lo general, el cambio de ubicación puede verse influido por las propiedades internas de un cuerpo o de un sistema físico. Incluso el estudio del movimiento en toda su generalidad lleva a considerar el cambio de dicho estado físico. La descripción del movimiento de los cuerpos físicos se denomina cinemática, y es una disciplina que pretende describir el modo en que un determinado cuerpo se mueve y las propiedades que tiene dicho movimiento. La física clásica nació estudiando la cinemática de cuerpos rígidos.  ",
        "options": [
            "El estudio del movimiento se refiere al cambio de ubicación en el espacio y en el tiempo ",
            "Esta disciplina describe el modo en que se mueve un cuerpo ",
            "La descripción del movimiento de los cuerpos físicos se denomina cinemática ",
            "El movimiento debe ser medido por un observador físico "
        ],
        "correct": " La descripción del movimiento de los cuerpos físicos se denomina cinemática",
        "subject": "Verbal",
        "id": "M017",
        "flag": false
    },
    {
        "question": "  Complete la oración con la palabra que exprese la relación similar. Tronco es a árbol como _______ es a flor. ",
        "options": [
            "Filamento",
            "Pétalo",
            "Pistilo",
            "Tallo"
        ],
        "correct": "Tallo",
        "subject": "Verbal",
        "id": "M018",
        "flag": false
    },
    {
        "question": " Identifique el termino excluido ",
        "options": [
            "Los Ríos",
            "El Oro",
            "Santa Elena",
            "Esmeraldas"
        ],
        "correct": "Los Ríos",
        "subject": "Verbal",
        "id": "M019",
        "flag": false
    },
    {
        "question": "Con base en el texto, seleccione un sinónimo de la palabra en negrita. En algunas culturas, como la celta, dálmata, griega o romana, se tenía la costumbre de aprovechar la toxicidad de las plantas para obtener de ellas un tipo de tósigo, con el que untaban las puntas de las flechas para incrementar su letalidad.",
        "options": [
            "RevUlsivo",
            "Veneno",
            "Antídoto",
            "Contraveneno"
        ],
        "correct": "Veneno",
        "subject": "Verbal",
        "id": "M020",
        "flag": false
    },
    {
        "question": "  Con base al texto identifique el antónimo de la palabra en negrita.  Aunque, como se ha visto, el fenómeno del préstamo lingüístico es algo natural que no cabe censurar en modo alguno, es necesario tener en cuenta que la proliferación indiscriminada de extranjerismos crudos o semiadaptados en textos españoles puede resultar un factor desestabilizador de nuestro sistema ortográfico. Giménez, D. (2002). Los extranjerismos en el español académico del siglo XIX. Recuperado el 14 de julio de 2015 en www.uv.es./normas ",
        "options": [
            "Desmesurada",
            "Selectiva",
            "Indistinta",
            "Consensuada"
        ],
        "correct": "Consensuada",
        "subject": "Verbal",
        "id": "M021",
        "flag": false
    },
    {
        "question": "  Con base en el texto, identifique el antónimo de la palabra en negrita. Pero el héroe de mi cuento era un petulante que quería escribir para que se enterasen, y es natural, así no puede ser, no le resultaba cuanto escribía sino paradojas. ",
        "options": [
            "Humilde",
            "Delirante",
            "Vanidoso",
            "Engreído"
        ],
        "correct": "Humilde",
        "subject": "Verbal",
        "id": "M022",
        "flag": false
    },
    {
        "question": "   Con base en el texto, seleccione el sinónimo de la palabra en negrita. Instrumentaba un proceso que consistía en conceder al reo un periodo de gracia de quince a treinta días para que pueda abjurar, tras lo cual, se le imponía una penitencia",
        "options": [
            "Decidir",
            "Confesar",
            "Mentir",
            "Retractar"
        ],
        "correct": "Retractar",
        "subject": "Verbal",
        "id": "M023",
        "flag": false
    },
    {
        "question": "El significado opuesto de Planear es: ",
        "options": [
            "Disponer",
            "Realizar",
            "Forjar",
            "Idear"
        ],
        "correct": "Realizar",
        "subject": "Verbal",
        "id": "M023",
        "flag": false
    },
    {
        "question": "Complete la siguiente analogía: __________ esa ____________ como herramienta a operación.",
        "options": [
            "Lápiz – calculo ",
            "Manguera – riego ",
            "Herramienta – operación ",
            "Arado – surco "
        ],
        "correct": "Arado – surco ",
        "subject": "verbal",
        "id": "M025",
        "flag": false
    },
    {
        "question": "¿Cuál de la siguientes palabras no encaja con las restantes?   ",
        "options": [
            "León",
            "lobo",
            "Guepardo",
            "Puma"
        ],
        "correct": "Lobo",
        "subject": "Verbal",
        "id": "M026",
        "flag": false
    }
];

const questionsCurrent = [];
const boxButtons = document.querySelector("#box_buttons");
const boxQuestion = document.querySelector("#box_question");
const btnNavigate = document.querySelector("#btn_nav")
const h5Title = document.querySelector("#title");
const image = document.querySelector("#img");
const responses = [];
var posGlobal = 0;
//Timer
var upgradeTime = 1800;//1800
var seconds = upgradeTime;
var countdownTimer;
var urlmegapro = window.location.origin;

const partials = getRandoms(20);


for (let index = 0; index < partials.length; index++) {
    questionsCurrent.push(questions[partials[index]]);
}

boxButtons.innerHTML = "";
let index = 0;
for (const q of questionsCurrent) {
    boxButtons.innerHTML += `<button id="btn${index}" class="btn p-0 custom">${index + 1}</button>`;
    responses.push({
        "id": q.id,
        "response": ""
    })
    index++;
}



function renderQuestion(index) {
    const btnCurrent = document.querySelector(`#btn${posGlobal}`);
    btnCurrent.className = "btn p-0 checked"
    h5Title.innerHTML = `Razonamiento Verbal - Pregunta ${posGlobal + 1} de 20`;
    boxQuestion.innerHTML = "";
    boxQuestion.innerHTML = `
    <p class="text-justify">${questionsCurrent[index].question}</p> 
    `;
    boxQuestion.innerHTML += renderOptions(questionsCurrent[index], index)
}

function renderOptions(question, index) {
    let html = "";
    let account = 0;
    for (const o of question.options) {
        html += `
        <div onclick="saveSelected('${o.toString()}', ${index}, 'radio${account}');" class="form-check opt custom-radio border mb-1">
        <input type="radio" id="radio${account}" name="customRadio" class="form-check-input opt">
        <label class="form-check-label opt" style="width: 100%; height: 100%;"
            for="radio${account}">
            <p class="mb-0 opt">${o.toString()}</p>
        </label>
        </div>
        `
        account++;
    }
    return html;
}

function saveSelected(selected, index, radio) {
    change(radio);
    responses[index].response = selected.toString();
}

function change(id) {
    const radioCheked = document.querySelector(`#${id}`);
    radioCheked.checked = true;

}

btnNavigate.addEventListener("click", () => {
    if (posGlobal + 1 < responses.length) {
        const { response } = responses[posGlobal];
        const btnCurrent = document.querySelector(`#btn${posGlobal}`);
        if (response.toString() === "") {
            btnCurrent.className = "btn p-0 custom"
        } else {
            btnCurrent.className = "btn p-0 yes-response"
        }
        posGlobal = posGlobal + 1;
        if (posGlobal === (responses.length - 1)) {
            btnNavigate.innerHTML = "Terminar simulador!";
        }
        renderQuestion(posGlobal);
    } else {
        localStorage.setItem('megapro_res', JSON.stringify(responses));
        localStorage.setItem('megapro_ques', JSON.stringify(questionsCurrent));
        const url = + "/megapro/site/resultados.html";
        //window.location.href = urlmegapro + "/site/resultados.html";
        window.location.href = urlmegapro + "/resultados.html"
    }


});


renderQuestion(0);
renderImage();

function renderImage() {
    const random = getRandomArbitrary(1, 6);
    image.src = `./images/sim/${random}.jpeg`
}

function timer() {
    var days = Math.floor(seconds / 24 / 60 / 60);
    var hoursLeft = Math.floor((seconds) - (days * 86400));
    var hours = Math.floor(hoursLeft / 3600);
    var minutesLeft = Math.floor((hoursLeft) - (hours * 3600));
    var minutes = Math.floor(minutesLeft / 60);
    var remainingSeconds = seconds % 60;
    if (remainingSeconds < 10) {
        remainingSeconds = "0" + remainingSeconds;
    }
    if (minutes < 10) {
        minutes = "0" + minutes;
    }
    document.getElementById('timer').innerHTML = "";

    document.getElementById('timer').innerHTML = ' <strong> Tiempo: ' + hours + ":" + minutes + ":" + remainingSeconds + '</strong>';

    // if (seconds == 5390) {
    //     alert('En 10 minutos terminará el examen');
    // }

    if (seconds === 0) {
        clearInterval(countdownTimer);
        alert('El examen ha terminado!');
        window.location.href = urlmegapro + "/site/resultados.html";
    } else {
        seconds--;
    }
}

function getRandoms(size) {
    const numbers = [];
    for (let index = 0; index < size; index++) {
        let number = getRandomArbitrary(0, 26);
        while (numbers.includes(number)) {
            number = getRandomArbitrary(0, 26);
        }
        numbers.push(number);
    }
    return numbers;
}

function getRandomArbitrary(min, max) {
    return Math.trunc(Math.random() * (max - min) + min);
}

countdownTimer = setInterval('timer()', 1000);
